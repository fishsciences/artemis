<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate the probability of detection — est_p_detect • artemis</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate the probability of detection — est_p_detect"><meta property="og:description" content="Estimate the probability of detection"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">artemis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/artemis-overview.html">Getting started with the artemis package</a>
    </li>
    <li>
      <a href="../articles/background.html">The motivation behind the artemis package</a>
    </li>
    <li>
      <a href="../articles/modeling.html">Modeling eDNA qPCR Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulating eDNA Data with `artemis`</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the probability of detection</h1>
    
    <div class="hidden name"><code>est_p_detect.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the probability of detection</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">est_p_detect</span><span class="op">(</span></span>
<span>  <span class="va">variable_levels</span>,</span>
<span>  <span class="va">betas</span>,</span>
<span>  <span class="va">ln_eDNA_sd</span>,</span>
<span>  <span class="va">std_curve_alpha</span>,</span>
<span>  <span class="va">std_curve_beta</span>,</span>
<span>  n_rep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>  prob_zero <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>  model_fit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upper_Cq <span class="op">=</span> <span class="fl">40</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>variable_levels</dt>
<dd><p>numeric vector, with each element
corresponding to the condition to estimate the probability of
detection.</p></dd>


<dt>betas</dt>
<dd><p>numeric vector, the effect sizes for each of the
variable level</p></dd>


<dt>ln_eDNA_sd</dt>
<dd><p>the measurement error on ln[eDNA]. If a
model_fit is provided and this is missing, the estimated
sd(ln_eDNA) from the model will be used.</p></dd>


<dt>std_curve_alpha</dt>
<dd><p>the alpha for the std. curve formula for
conversion between log(concentration) and CQ</p></dd>


<dt>std_curve_beta</dt>
<dd><p>the alpha for the std. curve formula for
conversion between log(concentration) and CQ</p></dd>


<dt>n_rep</dt>
<dd><p>the number of replicate measurements at the levels
specified</p></dd>


<dt>prob_zero</dt>
<dd><p>the probability of seeing a non-detection,
i.e. zero, from a zero-inflated process. Defaults to 8<!-- %, which -->
is the rate of inflated zeros in a large sampling experiment.</p></dd>


<dt>model_fit</dt>
<dd><p>optional, a model fit from <code>eDNA_lm</code> or
<code>eDNA_lmer</code>.  If this is provided, an estimate derived
from the posterior estimates of beta is calculated.</p></dd>


<dt>upper_Cq</dt>
<dd><p>the upper limit on detection. Converted to the
lower_bound of detection internally</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>object of class "eDNA_p_detect" with the estimates of the
    probability of detection for the variable levels provided.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function estimates the probability of getting a positive
detection for an eDNA survey given a set of predictors. This can
be useful when trying to take the estimates from a preliminary
study and use those estimates to inform the deployment of future
sampling schemes. The function assumes that you have either an
idea of the effects of the various predictors, for example from a
previous study, or a fit model with estimates of the effect sizes.</p>
<p>This function takes one circumstance at a time, and calculates the
range of outcomes given a number of repeated sampling
attempts. The probability calculated is the probability of getting
at least one positive detection. For details on the underlying
model and assumptions for this calculation, please refer to the
package vignette.</p>
    </div>
    <div id="notes-on-random-effects">
    <h2>Notes on random effects</h2>
    


<p>This function deals with random effects in two different
ways. First, when we desire to see the probability of detection
for a specific instance of a random effect, users can specify the
random effect as just another effect by specifying the random
effect = 1 in the variable list, and then the size of the random
effect. However, when users wish to estimate the probability of
detection in cases where random effects are generated from a
distribution of random effects, this can be accomplished by adding
the standard deviation of the random effect to the
<code>Cq_sd</code>. This takes advantage of the fact that random effects
are just another source of variation, and that sum of random
normal distributions is itself a random normal distribution.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Matt Espe</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">est_p_detect</span><span class="op">(</span>variable_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="fl">1</span>, Distance <span class="op">=</span> <span class="fl">100</span>, Volume <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             betas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="op">-</span><span class="fl">10.5</span>, Distance <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>, Volume <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             ln_eDNA_sd <span class="op">=</span> <span class="fl">1</span>, std_curve_alpha <span class="op">=</span> <span class="fl">21.2</span>, std_curve_beta <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>             n_rep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variable levels: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept  Distance    Volume </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1       100        20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    n_reps    p_detect</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1 0.001477609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       2 0.002953034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       3 0.004426279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       4 0.005897347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       5 0.007366242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       6 0.008832966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       7 0.010297523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       8 0.011759916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       9 0.013220148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     10 0.014678222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     11 0.016134142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     12 0.017587911</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matt Espe, Myfanwy Johnston.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

