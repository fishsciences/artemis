<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit eDNA Model — eDNA_lm • artemis</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit eDNA Model — eDNA_lm" />
<meta property="og:description" content="Fit eDNA model" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">artemis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/artemis-installation-guide.html">ARTEMIS Installation Guide</a>
    </li>
    <li>
      <a href="../articles/artemis-overview.html">Getting started with the artemis package</a>
    </li>
    <li>
      <a href="../articles/modeling.html">Modeling eDNA qPCR Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulating eDNA Data with `artemis`</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit eDNA Model</h1>
    
    <div class="hidden name"><code>eDNA_lmer.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit eDNA model</p>
    </div>

    <pre class="usage"><span class='fu'>eDNA_lm</span>(
  <span class='no'>formula</span>,
  <span class='no'>data</span>,
  <span class='no'>std_curve_alpha</span>,
  <span class='no'>std_curve_beta</span>,
  <span class='kw'>upper_Cq</span> <span class='kw'>=</span> <span class='fl'>40</span>,
  <span class='kw'>n_chain</span> <span class='kw'>=</span> <span class='fl'>4L</span>,
  <span class='kw'>iters</span> <span class='kw'>=</span> <span class='fl'>1000L</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='normal.html'>normal</a></span>(<span class='kw'>location</span> <span class='kw'>=</span> -<span class='fl'>15</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>10</span>),
  <span class='kw'>priors</span> <span class='kw'>=</span> <span class='fu'><a href='normal.html'>normal</a></span>(),
  <span class='kw'>Cq_error_type</span> <span class='kw'>=</span> <span class='st'>"fixed"</span>,
  <span class='kw'>sink_file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>(),
  <span class='no'>...</span>
)

<span class='fu'>eDNA_lmer</span>(
  <span class='no'>formula</span>,
  <span class='no'>data</span>,
  <span class='no'>std_curve_alpha</span>,
  <span class='no'>std_curve_beta</span>,
  <span class='kw'>upper_Cq</span> <span class='kw'>=</span> <span class='fl'>40</span>,
  <span class='kw'>n_chain</span> <span class='kw'>=</span> <span class='fl'>4L</span>,
  <span class='kw'>iters</span> <span class='kw'>=</span> <span class='fl'>500L</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='normal.html'>normal</a></span>(<span class='kw'>location</span> <span class='kw'>=</span> -<span class='fl'>15</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>10</span>),
  <span class='kw'>priors</span> <span class='kw'>=</span> <span class='fu'><a href='normal.html'>normal</a></span>(),
  <span class='kw'>Cq_error_type</span> <span class='kw'>=</span> <span class='st'>"fixed"</span>,
  <span class='kw'>sink_file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>(),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a formula, specifying the relationship between the
predictors and the latent variable eDNA concentration.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data.frame, with the response and predictors</p></td>
    </tr>
    <tr>
      <th>std_curve_alpha</th>
      <td><p>the alpha value for the formula for
converting between log(eDNA concentration) and CQ value</p></td>
    </tr>
    <tr>
      <th>std_curve_beta</th>
      <td><p>the beta value for the formula for
converting between log(eDNA concentration) and CQ value</p></td>
    </tr>
    <tr>
      <th>upper_Cq</th>
      <td><p>numeric, the upper limit on CQ detection. Any
value of log(concentration) which would result in a value
greater than this limit is instead recorded as the limit.</p></td>
    </tr>
    <tr>
      <th>n_chain</th>
      <td><p>integer, the number of chains to use. Please note
that less than two is not recommended.</p></td>
    </tr>
    <tr>
      <th>iters</th>
      <td><p>integer, the number of iterations per chain</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical, when TRUE output from
<code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>rstan::sampling</a></code> is written to the console.</p></td>
    </tr>
    <tr>
      <th>prior_intercept</th>
      <td><p>named list such as created by
<code><a href='https://mc-stan.org/rstanarm/reference/priors.html'>rstanarm::normal</a></code>. The list must contain elements named
"location" and "scale", which are the location and scale for a
normal prior over the intercept. Ignored when the intercept is
omitted in the model formula.</p></td>
    </tr>
    <tr>
      <th>priors</th>
      <td><p>named list such as created by
<code><a href='https://mc-stan.org/rstanarm/reference/priors.html'>rstanarm::normal</a></code>. The list must contain elements named
"location" and "scale", which are the location and scale for a
normal prior over the betas, and "autoscale". If a single
value is provided, this value will be repeated for each
beta. If <code>autoscale = TRUE</code>, the scale of the priors is
scaled by the sd of the predictors similar to rstanarm handles
them.</p></td>
    </tr>
    <tr>
      <th>Cq_error_type</th>
      <td><p>either "fixed" or "varying", specifying if
measurement error is assumed to be the same for all values of
CQ, or if it increases or decreases as CQ increases.</p></td>
    </tr>
    <tr>
      <th>sink_file</th>
      <td><p>character, a file to write the console output to
if <code>verbose = FALSE</code>, by default writes to
<code><a href='https://rdrr.io/r/base/tempfile.html'>tempfile()</a></code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to
<code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>sampling</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>S4 object, with the following slots:</p><dl'>
    <dt>ln_conc</dt><dd><p>matrix, the posterior samples for the latent
    variable, eDNA concentration</p></dd> <dt>Cq_star</dt><dd><p>matrix, the
    posterior prediction for the observed response</p></dd>
    <dt>betas</dt><dd><p>array, the posterior estimates for the betas for
    the linear model</p></dd> <dt>sigma_Cq</dt><dd><p>array, the posterior
    estimates for the measurement error of CQ</p></dd>
    <dt>formula</dt><dd><p>formula, the original formula used in the
    model</p></dd> <dt>x</dt><dd><p>data.frame, the model matrix used in the
    model</p></dd> <dt>std_curve_alpha</dt><dd><p>numeric, the std. curve value
    used</p></dd> <dt>std_curve_beta</dt><dd><p>numeric, the std. curve value
    used</p></dd> <dt>upper_Cq</dt><dd><p>numeric, the upper limit for observed CQ
    used</p></dd> <dt>stanfit</dt><dd><p>stanfit, the original results from
    <code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>rstan::sampling</a></code></p></dd> 
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions fit a Bayesian latent variable model to data
collected from a eDNA sampling experiment. These data have a few
particular characteristics that justify using a specialized
model. More details on these characteristics and the model
structure, please refer to the "Getting Started" vignette for the
artemis package.</p>
<p>There are two different modeling functions in the artemis package,
<code>eDNA_lm</code> and <code>eDNA_lmer</code>. <code>eDNA_lm</code> is for fitting
a fixed effects model, while <code>eDNA_lmer</code> is for fitting a
mixed or random effects model. Both models are fit using the
<code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>rstan::sampling</a></code> function, which uses a Hamiltonian Monte
Carlo algorithm to estimate parameters for the model. Users are
encouraged to refer to the documentation for Stan and RStan at
<a href='https://mc-stan.org/users/documentation/'>https://mc-stan.org/users/documentation/</a> for details about
how models are fit.</p>
    <h2 class="hasAnchor" id="diagnosing-warning-and-error-messages"><a class="anchor" href="#diagnosing-warning-and-error-messages"></a>Diagnosing warning and error messages</h2>

    


<p>The models have been written in Stan with key focus on robustness
and speed. However, it is possible that users might encounter
issues. Typically, these issues will be highlighted by warning
messages, which will be displayed regardless of the value of
<code>verbose</code>. Often times, these warnings can be resolved by
increasing the number of iterations that the HMC algorithm runs by
specifying <code>iters</code> to be a larger value. This should be the
first action attempted, as increasing the <code>iters</code> increases
both the warm-up and sampling iterations. If users continue to
have issues, additional control arguments can be passed to
<code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>rstan::sampling</a></code> via the <code>...</code> argument.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Fixed effect model</span>
<span class='no'>ans</span> <span class='kw'>=</span> <span class='fu'>eDNA_lm</span>(<span class='no'>Cq</span> ~ <span class='no'>Distance</span>, <span class='no'>eDNA_data</span>,
              <span class='kw'>std_curve_alpha</span> <span class='kw'>=</span> <span class='fl'>21.2</span>, <span class='kw'>std_curve_beta</span> <span class='kw'>=</span> -<span class='fl'>1.5</span>)</div><div class='output co'>#&gt; <span class='message'>Model executable is up to date!</span></div><div class='output co'>#&gt; Running MCMC with 4 chain(s) on 1 core(s)...
#&gt; 
#&gt; Running ./eDNA_omni 'id=1' random 'seed=346871191' data \
#&gt;   'file=/tmp/Rtmpe8oEkC/standata-10dfe79a4e35.json' output \
#&gt;   'file=/tmp/Rtmpe8oEkC/eDNA_omni-202006231344-1-b8aec1.csv' 'method=sample' \
#&gt;   'save_warmup=0' 'algorithm=hmc' 'engine=nuts' adapt 'engaged=1'</div><div class='output co'>#&gt; <span class='message'>Chain 1 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 Gradient evaluation took 8.8e-05 seconds</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 1000 transitions using 10 leapfrog steps per transition would take 0.88 seconds.</span></div><div class='output co'>#&gt; <span class='message'>Chain 1 Adjust your expectations accordingly!</span></div><div class='output co'>#&gt; Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
#&gt; Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
#&gt; Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
#&gt; Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
#&gt; Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
#&gt; Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
#&gt; Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
#&gt; Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
#&gt; Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
#&gt; Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
#&gt; Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
#&gt; Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
#&gt; Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
#&gt; Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
#&gt; Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
#&gt; Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
#&gt; Chain 1 finished in 7.7 seconds.
#&gt; Running ./eDNA_omni 'id=2' random 'seed=432744511' data \
#&gt;   'file=/tmp/Rtmpe8oEkC/standata-10dfe79a4e35.json' output \
#&gt;   'file=/tmp/Rtmpe8oEkC/eDNA_omni-202006231344-2-b8aec1.csv' 'method=sample' \
#&gt;   'save_warmup=0' 'algorithm=hmc' 'engine=nuts' adapt 'engaged=1'</div><div class='output co'>#&gt; <span class='message'>Chain 2 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2 Gradient evaluation took 0.000104 seconds</span></div><div class='output co'>#&gt; <span class='message'>Chain 2 1000 transitions using 10 leapfrog steps per transition would take 1.04 seconds.</span></div><div class='output co'>#&gt; <span class='message'>Chain 2 Adjust your expectations accordingly!</span></div><div class='output co'>#&gt; Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
#&gt; Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
#&gt; Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
#&gt; Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
#&gt; Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
#&gt; Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
#&gt; Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
#&gt; Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
#&gt; Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
#&gt; Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
#&gt; Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
#&gt; Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
#&gt; Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
#&gt; Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
#&gt; Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
#&gt; Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
#&gt; Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
#&gt; Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
#&gt; Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
#&gt; Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
#&gt; Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
#&gt; Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
#&gt; Chain 2 finished in 8.1 seconds.
#&gt; Running ./eDNA_omni 'id=3' random 'seed=31749990' data \
#&gt;   'file=/tmp/Rtmpe8oEkC/standata-10dfe79a4e35.json' output \
#&gt;   'file=/tmp/Rtmpe8oEkC/eDNA_omni-202006231344-3-b8aec1.csv' 'method=sample' \
#&gt;   'save_warmup=0' 'algorithm=hmc' 'engine=nuts' adapt 'engaged=1'</div><div class='output co'>#&gt; <span class='message'>Chain 3 Rejecting initial value:</span></div><div class='output co'>#&gt; <span class='message'>Chain 3   Gradient evaluated at the initial value is not finite.</span></div><div class='output co'>#&gt; <span class='message'>Chain 3   Stan can't start sampling from this initial value.</span></div><div class='output co'>#&gt; <span class='message'>Chain 3 Gradient evaluation took 0.000229 seconds</span></div><div class='output co'>#&gt; <span class='message'>Chain 3 1000 transitions using 10 leapfrog steps per transition would take 2.29 seconds.</span></div><div class='output co'>#&gt; <span class='message'>Chain 3 Adjust your expectations accordingly!</span></div><div class='output co'>#&gt; Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </div><div class='output co'>#&gt; <span class='message'>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span></div><div class='output co'>#&gt; <span class='message'>Chain 3 Exception: normal_lpdf: Scale parameter[1] is 0, but must be &gt; 0! (in '/tmp/RtmpGK0qHi/model-e18d6ef39c68.stan', line 231, column 1 to line 234, column 40)</span></div><div class='output co'>#&gt; <span class='message'>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span></div><div class='output co'>#&gt; <span class='message'>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span></div><div class='output co'>#&gt; <span class='message'>Chain 3 </span></div><div class='output co'>#&gt; Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
#&gt; Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
#&gt; Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
#&gt; Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
#&gt; Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
#&gt; Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
#&gt; Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
#&gt; Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
#&gt; Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
#&gt; Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
#&gt; Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
#&gt; Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
#&gt; Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
#&gt; Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
#&gt; Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
#&gt; Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
#&gt; Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
#&gt; Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
#&gt; Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
#&gt; Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
#&gt; Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
#&gt; Chain 3 finished in 8.4 seconds.
#&gt; Running ./eDNA_omni 'id=4' random 'seed=2137934383' data \
#&gt;   'file=/tmp/Rtmpe8oEkC/standata-10dfe79a4e35.json' output \
#&gt;   'file=/tmp/Rtmpe8oEkC/eDNA_omni-202006231344-4-b8aec1.csv' 'method=sample' \
#&gt;   'save_warmup=0' 'algorithm=hmc' 'engine=nuts' adapt 'engaged=1'
#&gt; Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
#&gt; Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
#&gt; Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
#&gt; Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
#&gt; Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
#&gt; Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
#&gt; Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
#&gt; Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
#&gt; Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
#&gt; Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
#&gt; Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
#&gt; Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
#&gt; Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
#&gt; Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
#&gt; Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
#&gt; Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
#&gt; Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
#&gt; Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
#&gt; Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
#&gt; Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
#&gt; Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
#&gt; Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
#&gt; Chain 4 finished in 7.9 seconds.
#&gt; 
#&gt; All 4 chains finished successfully.
#&gt; Mean chain execution time: 8.0 seconds.
#&gt; Total execution time: 32.2 seconds.</div><div class='input'>
<span class='co'>## Mixed-effect model</span>
<span class='co'>## This takes a while to run</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>ans2</span> <span class='kw'>=</span> <span class='fu'>eDNA_lmer</span>(<span class='no'>Cq</span> ~ <span class='no'>Distance</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>SampleID</span>), <span class='no'>eDNA_data</span>,
                 <span class='kw'>std_curve_alpha</span> <span class='kw'>=</span> <span class='fl'>21.2</span>, <span class='kw'>std_curve_beta</span> <span class='kw'>=</span> -<span class='fl'>1.5</span>)

}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Myfanwy Johnston, Matt Espe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


