<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate power — est_power_lm • artemis</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Estimate power — est_power_lm" />

<meta property="og:description" content="Estimate the power for a given eDNA design" />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">artemis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/artemis-installation-guide.html">ARTEMIS Installation Guide</a>
    </li>
    <li>
      <a href="../articles/artemis-overview.html">Getting started with the artemis package</a>
    </li>
    <li>
      <a href="../articles/modeling.html">Modeling eDNA qPCR Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulating eDNA Data with `artemis`</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate power</h1>
    
    <div class="hidden name"><code>est_power_lmer.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Estimate the power for a given eDNA design</p>
    
    </div>

    <pre class="usage"><span class='fu'>est_power_lm</span>(<span class='no'>formula</span>, <span class='no'>variable_list</span>, <span class='no'>betas</span>, <span class='no'>sigma_Cq</span>, <span class='no'>std_curve_alpha</span>,
  <span class='no'>std_curve_beta</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"exclude_zero"</span>, <span class='st'>"accuracy"</span>),
  <span class='kw'>accuracy_level</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>conf_level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>n_sim</span> <span class='kw'>=</span> <span class='fl'>200L</span>,
  <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fu'><a href='conf_to_probs.html'>conf_to_probs</a></span>(<span class='no'>conf_level</span>), <span class='kw'>upper_Cq</span> <span class='kw'>=</span> <span class='fl'>40</span>,
  <span class='kw'>X</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='no'>variable_list</span>), <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>est_power_lmer</span>(<span class='no'>formula</span>, <span class='no'>variable_list</span>, <span class='no'>betas</span>, <span class='no'>sigma_Cq</span>, <span class='no'>sigma_rand</span>,
  <span class='no'>std_curve_alpha</span>, <span class='no'>std_curve_beta</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"exclude_zero"</span>, <span class='st'>"accuracy"</span>),
  <span class='kw'>accuracy_level</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>conf_level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>n_sim</span> <span class='kw'>=</span> <span class='fl'>200L</span>,
  <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fu'><a href='conf_to_probs.html'>conf_to_probs</a></span>(<span class='no'>conf_level</span>), <span class='kw'>upper_Cq</span> <span class='kw'>=</span> <span class='fl'>40</span>,
  <span class='kw'>X</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='no'>variable_list</span>), <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a model formula, e.g. <code>y ~ x1 + x2</code>. For
<code>sim_eDNA_lmer</code>, random intercepts can also be provided,
e.g. <code> ( 1 | rep ) </code>.</p></td>
    </tr>
    <tr>
      <th>variable_list</th>
      <td><p>a named list, with the levels that each
variable can take.  Please note that the variables listed in
the formula, including the response variable, must be present
in the variable_list or in the X design matrix.  Extra
variables, i.e. variables which do not occur in the formula,
are ignored.</p></td>
    </tr>
    <tr>
      <th>betas</th>
      <td><p>numeric vector, the beta for each variable in the
design matrix</p></td>
    </tr>
    <tr>
      <th>sigma_Cq</th>
      <td><p>numeric, the measurement error on CQ.</p></td>
    </tr>
    <tr>
      <th>std_curve_alpha</th>
      <td><p>the alpha value for the formula for
converting between log(eDNA concentration) and CQ value</p></td>
    </tr>
    <tr>
      <th>std_curve_beta</th>
      <td><p>the beta value for the formula for
converting between log(eDNA concentration) and CQ value</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>either "exclude_zero" or "accuracy". Exclude_zero give
the classic power estimate, i.e. whether 0 is in the
confidence interval for the estimate ("significant"). Accuracy
measures whether the estimated betas are within some
percentage of the "true" betas used to simulate the data.</p></td>
    </tr>
    <tr>
      <th>accuracy_level</th>
      <td><p>numeric, between 0 and 1. The percent of the
true betas for the accuracy estimate.</p></td>
    </tr>
    <tr>
      <th>conf_level</th>
      <td><p>numeric, between 0 and 1, representing the
percent of the confidence interval to calculate. If
<code>probs</code> is not provided, then the interval is assumed to
be symetric.</p></td>
    </tr>
    <tr>
      <th>n_sim</th>
      <td><p>integer, the number of simulations to conduct in
order to estimate the power.</p></td>
    </tr>
    <tr>
      <th>probs</th>
      <td><p>probabilities for the calculation of the confidence
intervals. By default, a symetric set of lower and upper
probabilities is constructed by <code>conf_to_probs</code>)</p></td>
    </tr>
    <tr>
      <th>upper_Cq</th>
      <td><p>numeric, the upper limit on CQ detection. Any
value of log(concentration) which would result in a value
greater than this limit is instead recorded as the limit.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>optional, a design matrix. By default, this is created
from the variable_list using <code><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid()</a></code>, which
creates a balanced design matrix. However, the user can
provide their own <code>X</code> as well, in which case the
variable_list is ignored. This allows users to provide an
unbalanced design matrix.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical, when TRUE output from
<code><a href='https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html'>rstan::sampling</a></code> is written to the console.</p></td>
    </tr>
    <tr>
      <th>sigma_rand</th>
      <td><p>numeric vector, the stdev for the random
effects. There must be one sigma per random effect specified</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a named vector, with one estimate of the power for each
    parameter estimate.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions estimate the power for a given eDNA design and
specific effect sizes. The functions allow the user to specify to
either use the classic definition of power (i.e., whether an
estimate includes 0 in the confidence/credible interval), or
accuracy, defined as the estimates being within a certain
percentage of the "true" betas. Both can be useful in different
circumstances, but eDNA survey studies produce data where accuracy
can be a more useful metric. Since the response variable, Cq
values, are truncated at an upper limit, it is often possible to
detect a "significant effect" which results in Cq values above
this upper limit, but the effects are estimated with a high amount
of uncertainty. When are primarily interested in the precision of
the estimate, the classic definition of power is not helpful. For
these reasons, these functions allow the user to specify
"accuracy" as the metric of interest.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
          </ul>

    <h2>Author</h2>
    <p>Matt Espe</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Myfanwy Johnston, Matt Espe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


