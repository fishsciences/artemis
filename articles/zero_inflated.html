<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modeling Zero-Inflated eDNA qPCR Data with `artemis` • artemis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Modeling Zero-Inflated eDNA qPCR Data with `artemis`">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">artemis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/artemis-overview.html">Getting started with the artemis package</a>
    </li>
    <li>
      <a href="../articles/background.html">The motivation behind the artemis package</a>
    </li>
    <li>
      <a href="../articles/count_modeling.html">Modeling count eDNA qPCR Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/model_types.html">Models included in the `artemis` package and when to use them</a>
    </li>
    <li>
      <a href="../articles/modeling.html">Modeling eDNA qPCR Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulating eDNA Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/zero_inflated.html">Modeling Zero-Inflated eDNA qPCR Data with `artemis`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Modeling Zero-Inflated eDNA qPCR Data with <code>artemis</code>
</h1>
            
      

      <div class="hidden name"><code>zero_inflated.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">artemis</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction-to-zero-inflated-models">Introduction to Zero-inflated models<a class="anchor" aria-label="anchor" href="#introduction-to-zero-inflated-models"></a>
</h2>
<p>A zero-inflated model is a mixture model between two processes that both can result in zero values in the response variable. We use these models when we have more zero’s in the response variable than would be expected under a single model. Thus, the “zero-inflated” tries to capture the mechanisms that could results in these extra zeros.</p>
<p>For work in eDNA, there are several potential processes that could fall under a zero-inflated process, e.g. filter failures, reagent failures, etc. These are distinct from the zero values caused by the measured value falling under the limit of detection.</p>
<p><em>Note: The above applies to cases when the threshold of detection, i.e. the sensitivity of the assay, is relatively high. In cases when the assay is sensitive to single copies of DNA, the expected distribution is not Normal, and hence different modeling decisions are warranted.</em></p>
<p>In a zero inflated model, there are two components:</p>
<ul>
<li>the non-zero model, which is functionally similar to the non-zero inflated case</li>
<li>the zero-model, which determines the rate at which zero values can occur independent of the non-zero model.</li>
</ul>
<p>these two models are combined into a mixture where the likelihood is defined as</p>
<pre class="math"><code><span><span class="fu">p</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">=</span> <span class="fu">p</span><span class="op">(</span><span class="va">zero</span><span class="op">|</span><span class="va">X_1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">p</span><span class="op">(</span><span class="va">zero</span><span class="op">|</span><span class="va">X_1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">p</span><span class="op">(</span><span class="va">y</span><span class="op">|</span><span class="va">X_2</span><span class="op">)</span></span></code></pre>
<p>where <code>p(zero|X_1)</code> is the probability of zero, given data <code>X_1</code> and <code>p(y|X_2)</code> is the likelihood of <code>y</code> given data <code>X_2</code>. Note that the zero and non-zero components can be predicated on different data (i.e. the zero and non-zero models do not require matching terms).</p>
</div>
<div class="section level2">
<h2 id="fitting-zero-inflated-models-in-artemis">Fitting Zero-inflated Models in <code>artemis</code><a class="anchor" aria-label="anchor" href="#fitting-zero-inflated-models-in-artemis"></a>
</h2>
<p>Zero-inflated models can be fit in <code>artemis</code> via the <code>eDNA_zinf_lm*()</code> functions. For these functions, the model is specified as in the <code>glm</code> package, where the model formula for the non-zero model and the zero-inflated model are separated by a <code>|</code> in the model formula, e.g. </p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eDNA_lmer.html">eDNA_zinf_lm</a></span><span class="op">(</span><span class="va">Cq</span> <span class="op">~</span> <span class="va">Distance_m</span> <span class="op">+</span> <span class="va">Volume_mL</span> <span class="op">|</span> <span class="va">Distance_m</span>, <span class="va">eDNA_data</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p>In this formula, the term <code>~ Distance_m + Volume_ml</code> specifies the predictors for the non-zero model, whereas the <code>| Distance_m</code> term specifies the predictors for the zero-model.</p>
<p>The non-zero model follows the same form as the <code>eDNA_lm*()</code> models, namely a censored-data model using normally distributed errors.</p>
<p>The zero-inflated models can be summarized, printed, and plotted as any other model from the <code>artemis</code> package.</p>
</div>
<div class="section level2">
<h2 id="evaluating-a-zero-inflated-model">Evaluating a zero-inflated model<a class="anchor" aria-label="anchor" href="#evaluating-a-zero-inflated-model"></a>
</h2>
<p>The zero-inflated models can be compared using the <code><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo()</a></code> function, allowing model comparison.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matt Espe, Myfanwy Johnston.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
