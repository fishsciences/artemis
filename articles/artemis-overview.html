<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with the artemis package • artemis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with the artemis package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">artemis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/artemis-overview.html">Getting started with the artemis package</a>
    </li>
    <li>
      <a href="../articles/background.html">The motivation behind the artemis package</a>
    </li>
    <li>
      <a href="../articles/count_modeling.html">Modeling eDNA qPCR Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/model_types.html">Models included in the `artemis` package and when to use them</a>
    </li>
    <li>
      <a href="../articles/modeling.html">Modeling eDNA qPCR Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulating eDNA Data with `artemis`</a>
    </li>
    <li>
      <a href="../articles/zero_inflated.html">Modeling eDNA qPCR Data as Copy Number with `artemis`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with the artemis package</h1>
            
      

      <div class="hidden name"><code>artemis-overview.Rmd</code></div>

    </div>

    
    
<pre><code><span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span></code></pre>
<p>(Adapted from manuscript Espe et al, in review)</p>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>The <code>artemis</code> R package was created to aid in the design and analysis of environmental DNA (eDNA) survey studies by offering a custom suite of models for quantitative polymerase chain reaction (qPCR) data from extracted eDNA samples. Data from eDNA sampling surveys is often analyzed with occupancy models or GLMS, but there are several characteristics of qPCR data in particular which made us feel that it would benefit from a different modeling approach. Specifically, our approach to this data makes use of Bayesian truncated latent variable models written in <a href="https://mc-stan.org" class="external-link">Stan</a>.</p>
</div>
<div class="section level2">
<h2 id="modeling-qpcr-edna-data-with-artemis">Modeling qPCR eDNA Data with <code>artemis</code><a class="anchor" aria-label="anchor" href="#modeling-qpcr-edna-data-with-artemis"></a>
</h2>
<p>We created the <code>artemis</code> R package to implement Bayesian censored latent variable models, which mitigate the weaknesses of common statistical analysis techniques applied to qPCR data. Additionally, <code>artemis</code> includes utilities to aid in the design and analysis of eDNA survey studies, including simulation and power analysis functions.</p>
<p>At its core, <code>artemis</code> is a specialized Generalized Linear Model, where the predictors are assumed to additively affect the response variable, in this case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">ln[eDNA]</annotation></semantics></math>,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub><mo>=</mo><msub><mi>X</mi><mi>i</mi></msub><mi>β</mi></mrow><annotation encoding="application/x-tex"> ln[eDNA]_{i} = X_{i} \beta </annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math> is a vector of effects on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ln[eDNA]_{i}</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_{i}</annotation></semantics></math> is a vector of predictors. Since <code>artemis</code> directly models the effect of the predictors on the latent (unobserved) variable, [eDNA], it is unnecessary for the researcher to back-transform the data prior to modeling. Internally, <code>artemis</code> conducts this conversion using the user-supplied values for the formula,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mrow><mi>C</mi><msub><mi>q</mi><mi>i</mi></msub></mrow><mo accent="true">̂</mo></mover><mo>=</mo><msub><mi>α</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi><mi>_</mi><mi>c</mi><mi>u</mi><mi>r</mi><mi>v</mi><mi>e</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi><mi>_</mi><mi>c</mi><mi>u</mi><mi>r</mi><mi>v</mi><mi>e</mi></mrow></msub><mo>*</mo><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\hat{Cq_i} = \alpha_{std\_curve} + \beta_{std\_curve}* ln[eDNA]_i  </annotation></semantics></math></p>
<p>Where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi><mi>_</mi><mi>c</mi><mi>u</mi><mi>r</mi><mi>v</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">\alpha_{std\_curve}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi><mi>_</mi><mi>c</mi><mi>u</mi><mi>r</mi><mi>v</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">\beta_{std\_curve}</annotation></semantics></math> are fixed values from setting the standard curve in the lab prior to qPCR.</p>
<p>Internally, the back-transformed <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ln[eDNA]_i</annotation></semantics></math> values are considered a sample with measurement error from the true <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ln[eDNA]_i</annotation></semantics></math> value (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{ln[eDNA]_i}</annotation></semantics></math>) in the extract.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub><mo>∼</mo><mi>T</mi><mi>r</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>.</mi><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mo stretchy="false" form="prefix">(</mo><mover><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><mo accent="true">̂</mo></mover><mo>,</mo><msub><mi>σ</mi><mrow><mi>C</mi><mi>q</mi></mrow></msub><mo>,</mo><mi>U</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex"> ln[eDNA]_i \sim Trunc. Normal(\hat{ln[eDNA]_i}, \sigma_{Cq}, U) </annotation></semantics></math></p>
<p>Where the observed <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ln[eDNA]_i</annotation></semantics></math> values are censored at the predetermined threshold, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math>. This threshold is back-transformed from the threshold on Cq. Importantly, the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><mo stretchy="false" form="postfix">]</mo></mrow><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{ln[eDNA]}</annotation></semantics></math> values in the model are not censored, allowing the latent variable to reflect the “true” [eDNA] beyond the censorship point. The likelihood that a sampled <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">ln[eDNA]</annotation></semantics></math> value will exceed the threshold is a function of the measurement error and the estimated latent <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{ln[eDNA]_i}</annotation></semantics></math> value. We calculate this likelihood using the normal cumulative distribution function, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Φ</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\Phi()</annotation></semantics></math>,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mo stretchy="false" form="prefix">[</mo><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub><mo>&gt;</mo><mi>U</mi><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mn>1</mn><mo>−</mo><mi>Φ</mi><mo stretchy="false" form="prefix">(</mo><mover><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><msub><mo stretchy="false" form="postfix">]</mo><mi>i</mi></msub></mrow><mo accent="true">̂</mo></mover><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><mi>/</mi><mi>σ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex"> Pr[ln[eDNA]_i &gt; U ] = 1 - \Phi(\hat{ln[eDNA]_i} - \mu_i / \sigma)</annotation></semantics></math></p>
<p>Thus, the models in <code>artemis</code> account for the data censoring process by accounting for the probability that the observed value will exceed the threshold. As detection limits vary with genetic assay, the upper threshold on Cq in the model is adjustable by the user.</p>
<p>Lastly, there is an optional zero-inflated versions of both models, <code>eDNA_lm_zinf()</code> and <code>eDNA_lmer_zinf()</code>. From multiple experiments, it was observed there can be near-zero concentrations of eDNA even in situations where higher concentrations were expected. This was attributed to filter failures or other issues with sampling. To account for this mechanism, the zero-inflated versions of the models allow for zero [eDNA] concentrations from a secondary mechanism. Currently, the functions do not support user-provided predictors on the zero-inflated component, and just estimate a flat probability of zero detections for all observations. However, users can provide a prior for the expected probability of “true” zero observations from a secondary mechanism.</p>
<p>This model formulation makes several assumptions:</p>
<ol style="list-style-type: decimal">
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">ln[eDNA]</annotation></semantics></math> is assumed to be uniform within a sample.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">ln[eDNA]</annotation></semantics></math> is sampled with normally distributed errors.</p></li>
<li><p>There are no false detections, i.e. the measurement error cannot result in a positive detection when eDNA is not present in the sample.</p></li>
</ol>
<p>Importantly, this formulation produces estimates of the effect sizes which:</p>
<ul>
<li><p>are modeled directly on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mi>e</mi><mi>D</mi><mi>N</mi><mi>A</mi><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">ln[eDNA]</annotation></semantics></math> or copy number, rather than Cq, <em>therefore are independent of the standard curve and can be compared between studies that use different standard curves</em>.</p></li>
<li><p>account for the data censoring at the upper limit of qPCR cycles, <em>which properly accounts for uncertainty and reduces bias in the estimates.</em></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installing-artemis">Installing <code>artemis</code><a class="anchor" aria-label="anchor" href="#installing-artemis"></a>
</h2>
<p>The <code>artemis</code> installation guide can be found <a href="https://fishsciences.github.io/artemis/articles/artemis-installation-guide.html" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="a-note-on-included-sample-data">A note on included sample data<a class="anchor" aria-label="anchor" href="#a-note-on-included-sample-data"></a>
</h2>
<p>Since <code>artemis</code> was originally written to analyze aquatic eDNA samples, the examples and sample data included in the package (see <code><a href="../reference/eDNA_data.html">?eDNA_data</a></code>) reference variables that are specific to aquatic eDNA survey data. These variables include <code>volume</code> (the the number of mililiters of water that went through the filter in each sample) and <code>distance</code> (the distance in meters from the source of eDNA). For example, <code>eDNA_data</code> is from a “live car” experiment, where eDNA was sampled at known distances from a source of eDNA (fish in a net pen in unidirectional flow).</p>
<p>In the following examples, <code>tech_rep</code> refers to qPCR replicates generated from a single extracted sample or filter; <code>rep</code> refers to a single extracted filter or sample.</p>
</div>
<div class="section level2">
<h2 id="overview-of-artemis-functionality">Overview of <code>artemis</code> Functionality<a class="anchor" aria-label="anchor" href="#overview-of-artemis-functionality"></a>
</h2>
<p>The functions included in <code>artemis</code> can be grouped into a few categories; each category is either introduced in this vignette, or addressed in detail by its own vignette. <a href="https://fishsciences.github.io/artemis/articles/" class="external-link">Available vignettes</a> are linked to individually below:</p>
<ol style="list-style-type: decimal">
<li><a href="https://fishsciences.github.io/artemis/articles/simulation.html" class="external-link">Simulation of data</a></li>
<li><a href="https://fishsciences.github.io/artemis/articles/modeling.html" class="external-link">Modeling data</a></li>
<li>Conducting post-hoc analyses
<ul>
<li>estimating probability of detection, generating predictions from model fits.</li>
</ul>
</li>
<li>Conducting power and precision analyses</li>
</ol>
<p>These categories are addressed in the sections that follow.<br><br></p>
<p>The <code>artemis</code> package also includes methods for R’s <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>, and <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> functions.</p>
</div>
<div class="section level2">
<h2 id="post-hoc-analyses-pdetect">Post-hoc analyses (<em>p(detect)</em>)<a class="anchor" aria-label="anchor" href="#post-hoc-analyses-pdetect"></a>
</h2>
<p>Often purpose of an eDNA sampling study is to inform a field sampling protocol. For these cases, we often want to know how likely we are to detect eDNA, given the way that we sampled. <code>est_p_detect()</code> returns the probability of getting a detection across all planned samples and replicates, where <code>n_rep</code> represents the product of the number of filters and technical replicates for each filter. For example, if you planned to take 2-5 filters at each variable level and then complete 6 extractions for each filter, that would be <code>n_rep = 12:30</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_detect</span> <span class="op">=</span> <span class="fu"><a href="../reference/est_p_detect.html">est_p_detect_lm</a></span><span class="op">(</span>variable_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                            Distance <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                        betas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="op">-</span><span class="fl">10.5</span>, Distance <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span><span class="op">)</span>,</span>
<span>                        ln_eDNA_sd <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                        std_curve_alpha <span class="op">=</span> <span class="fl">21.2</span>, std_curve_beta <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>,</span>
<span>                        n_rep <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">p_detect</span></span>
<span><span class="co">#&gt; Variable levels: </span></span>
<span><span class="co">#&gt; Intercept  Distance </span></span>
<span><span class="co">#&gt;         1       100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    n_reps  p_detect</span></span>
<span><span class="co">#&gt; 1      12 0.8646429</span></span>
<span><span class="co">#&gt; 2      13 0.8854212</span></span>
<span><span class="co">#&gt; 3      14 0.9030098</span></span>
<span><span class="co">#&gt; 4      15 0.9178985</span></span>
<span><span class="co">#&gt; 5      16 0.9305016</span></span>
<span><span class="co">#&gt; 6      17 0.9411701</span></span>
<span><span class="co">#&gt; 7      18 0.9502009</span></span>
<span><span class="co">#&gt; 8      19 0.9578454</span></span>
<span><span class="co">#&gt; 9      20 0.9643164</span></span>
<span><span class="co">#&gt; 10     21 0.9697941</span></span>
<span><span class="co">#&gt; 11     22 0.9744309</span></span>
<span><span class="co">#&gt; 12     23 0.9783560</span></span>
<span><span class="co">#&gt; 13     24 0.9816785</span></span>
<span><span class="co">#&gt; 14     25 0.9844909</span></span>
<span><span class="co">#&gt; 15     26 0.9868717</span></span>
<span><span class="co">#&gt; 16     27 0.9888870</span></span>
<span><span class="co">#&gt; 17     28 0.9905929</span></span>
<span><span class="co">#&gt; 18     29 0.9920370</span></span>
<span><span class="co">#&gt; 19     30 0.9932593</span></span></code></pre></div>
<p>We can also plot this,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_detect</span><span class="op">)</span></span></code></pre></div>
<p><img src="artemis-overview_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Alternatively, we can also use a fit model to estimate the p(detect) for a set of circumstances. Unlike the above, using a fit model allows us to estimate the probability of detection with the uncertainty in our effect size estimates taken into account.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_fit</span> <span class="op">=</span> <span class="fu"><a href="../reference/eDNA_lmer.html">eDNA_lm</a></span><span class="op">(</span><span class="va">Cq</span> <span class="op">~</span> <span class="va">Distance_m</span> <span class="op">+</span> <span class="va">Volume_mL</span>, </span>
<span>                    data <span class="op">=</span> <span class="va">eDNA_data</span>,</span>
<span>                    std_curve_alpha <span class="op">=</span> <span class="fl">21.2</span>, std_curve_beta <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>,</span>
<span>                    seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                    chains <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Intercept is automatically supplied if in model_fit</span></span>
<span><span class="va">p_detect2</span> <span class="op">=</span> <span class="fu">est_p_detect</span><span class="op">(</span>variable_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Distance_m <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                             Volume_mL <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                        model_fit <span class="op">=</span> <span class="va">model_fit</span>, </span>
<span>                        n_rep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_detect2</span><span class="op">)</span></span></code></pre></div>
<p>and we can plot the results,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_detect2</span>, error_width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><br><br> — <br><br></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matt Espe, Myfanwy Johnston.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
